{
  "_class": "AST_Toplevel",
  "globals": [
    "1000176 require",
    "1000177 describe",
    "1000178 it",
    "1000179 Array",
    "1000180 undefined"
  ],
  "variables": [
    "1000001 assert",
    "1000002 proxyaddr",
    "1000166 createReq",
    "1000170 all",
    "1000172 none",
    "1000174 trust10x"
  ],
  "functions": [
    "1000166 createReq",
    "1000170 all",
    "1000172 none",
    "1000174 trust10x"
  ],
  "enclosed": [
    "1000176 require",
    "1000177 describe",
    "1000178 it",
    "1000001 assert",
    "1000002 proxyaddr",
    "1000166 createReq",
    "1000170 all",
    "1000179 Array",
    "1000172 none",
    "1000174 trust10x",
    "1000180 undefined"
  ],
  "body": [
    {
      "_class": "AST_Var",
      "definitions": [
        {
          "_class": "AST_VarDef",
          "name": {
            "_class": "AST_SymbolVar",
            "name": "assert",
            "thedef": "1000001 assert"
          },
          "value": {
            "_class": "AST_Call",
            "expression": {
              "_class": "AST_SymbolRef",
              "name": "require",
              "thedef": "1000176 require"
            },
            "args": [
              {
                "_class": "AST_String",
                "value": "assert",
                "quote": "'"
              }
            ]
          }
        }
      ]
    },
    {
      "_class": "AST_Var",
      "definitions": [
        {
          "_class": "AST_VarDef",
          "name": {
            "_class": "AST_SymbolVar",
            "name": "proxyaddr",
            "thedef": "1000002 proxyaddr"
          },
          "value": {
            "_class": "AST_Call",
            "expression": {
              "_class": "AST_SymbolRef",
              "name": "require",
              "thedef": "1000176 require"
            },
            "args": [
              {
                "_class": "AST_String",
                "value": "..",
                "quote": "'"
              }
            ]
          }
        }
      ]
    },
    {
      "_class": "AST_SimpleStatement",
      "body": {
        "_class": "AST_Call",
        "expression": {
          "_class": "AST_SymbolRef",
          "name": "describe",
          "thedef": "1000177 describe"
        },
        "args": [
          {
            "_class": "AST_String",
            "value": "proxyaddr(req, trust)",
            "quote": "'"
          },
          {
            "_class": "AST_Function",
            "name": null,
            "argnames": [],
            "uses_arguments": false,
            "variables": [
              "1000003 arguments"
            ],
            "enclosed": [
              "1000177 describe",
              "1000178 it",
              "1000001 assert",
              "1000002 proxyaddr",
              "1000166 createReq",
              "1000170 all",
              "1000179 Array",
              "1000172 none",
              "1000174 trust10x",
              "1000180 undefined"
            ],
            "body": [
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "arguments",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000004 arguments"
                      ],
                      "enclosed": [
                        "1000177 describe",
                        "1000178 it",
                        "1000001 assert",
                        "1000002 proxyaddr",
                        "1000166 createReq",
                        "1000170 all",
                        "1000179 Array"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "describe",
                              "thedef": "1000177 describe"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "req",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000005 arguments"
                                ],
                                "enclosed": [
                                  "1000178 it",
                                  "1000001 assert",
                                  "1000002 proxyaddr"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should be required",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000006 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "proxyaddr",
                                                    "thedef": "1000002 proxyaddr"
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "req.*required"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "describe",
                              "thedef": "1000177 describe"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "trust",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000007 arguments"
                                ],
                                "enclosed": [
                                  "1000178 it",
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000170 all",
                                  "1000179 Array"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should be required",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000008 arguments",
                                            "1000009 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000009 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000009 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000009 req"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "trust.*required"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept a function",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000010 arguments",
                                            "1000011 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000011 req",
                                            "1000170 all"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000011 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000011 req"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "all",
                                                        "thedef": "1000170 all"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept an array",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000012 arguments",
                                            "1000013 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000013 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000013 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000013 req"
                                                      },
                                                      {
                                                        "_class": "AST_Array",
                                                        "elements": []
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept a string",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000014 arguments",
                                            "1000015 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000015 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000015 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000015 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should reject a number",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000016 arguments",
                                            "1000017 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000017 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000017 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000017 req"
                                                      },
                                                      {
                                                        "_class": "AST_Number",
                                                        "value": 42
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "unsupported trust argument"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept IPv4",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000018 arguments",
                                            "1000019 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000019 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000019 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000019 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept IPv6",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000020 arguments",
                                            "1000021 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000021 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000021 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000021 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept IPv4-style IPv6",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000022 arguments",
                                            "1000023 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000023 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000023 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000023 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::ffff:127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept pre-defined names",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000024 arguments",
                                            "1000025 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000025 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000025 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000025 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "loopback",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept pre-defined names in array",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000026 arguments",
                                            "1000027 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000027 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000027 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000027 req"
                                                      },
                                                      {
                                                        "_class": "AST_Array",
                                                        "elements": [
                                                          {
                                                            "_class": "AST_String",
                                                            "value": "loopback",
                                                            "quote": "'"
                                                          },
                                                          {
                                                            "_class": "AST_String",
                                                            "value": "10.0.0.1",
                                                            "quote": "'"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should not alter input array",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000028 arguments",
                                            "1000029 arr",
                                            "1000030 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000030 req",
                                            "1000029 arr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "arr",
                                                    "thedef": "1000029 arr"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Array",
                                                    "elements": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "loopback",
                                                        "quote": "'"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000030 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000030 req"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "arr",
                                                        "thedef": "1000029 arr"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "deepEqual"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "arr",
                                                    "thedef": "1000029 arr"
                                                  },
                                                  {
                                                    "_class": "AST_Array",
                                                    "elements": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "loopback",
                                                        "quote": "'"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should reject non-IP",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000031 arguments",
                                            "1000032 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000032 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000032 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000032 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "blargh",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid IP address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000032 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.300.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid IP address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000032 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::ffff:30.168.1.9000",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid IP address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000032 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "-1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid IP address"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should reject bad CIDR",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000033 arguments",
                                            "1000034 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000034 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000034 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000034 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1/internet",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000034 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1/6000",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000034 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::1/6000",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000034 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::ffff:a00:2/136",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000034 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::ffff:a00:2/-1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should reject bad netmask",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000035 arguments",
                                            "1000036 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000036 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000036 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000036 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1/255.0.255.0",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000036 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1/ffc0::",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000036 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "fe80::/ffc0::",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000036 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "fe80::/255.255.255.0",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "proxyaddr",
                                                        "thedef": "1000002 proxyaddr"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000036 req"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::ffff:a00:2/255.255.255.0",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should be invoked as trust(addr, i)",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000037 arguments",
                                            "1000038 log",
                                            "1000039 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000002 proxyaddr",
                                            "1000039 req",
                                            "1000038 log",
                                            "1000179 Array",
                                            "1000001 assert"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "log",
                                                    "thedef": "1000038 log"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Array",
                                                    "elements": []
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000039 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      },
                                                      {
                                                        "_class": "AST_Object",
                                                        "properties": [
                                                          {
                                                            "_class": "AST_ObjectKeyVal",
                                                            "quote": "'",
                                                            "key": "x-forwarded-for",
                                                            "value": {
                                                              "_class": "AST_String",
                                                              "value": "192.168.0.1, 10.0.0.1",
                                                              "quote": "'"
                                                            }
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_SymbolRef",
                                                  "name": "proxyaddr",
                                                  "thedef": "1000002 proxyaddr"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "req",
                                                    "thedef": "1000039 req"
                                                  },
                                                  {
                                                    "_class": "AST_Function",
                                                    "name": null,
                                                    "argnames": [
                                                      {
                                                        "_class": "AST_SymbolFunarg",
                                                        "name": "addr",
                                                        "thedef": "1000041 addr"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolFunarg",
                                                        "name": "i",
                                                        "thedef": "1000042 i"
                                                      }
                                                    ],
                                                    "uses_arguments": true,
                                                    "variables": [
                                                      "1000040 arguments",
                                                      "1000041 addr",
                                                      "1000042 i"
                                                    ],
                                                    "enclosed": [
                                                      "1000038 log",
                                                      "1000179 Array",
                                                      "1000040 arguments"
                                                    ],
                                                    "body": [
                                                      {
                                                        "_class": "AST_Return",
                                                        "value": {
                                                          "_class": "AST_Call",
                                                          "expression": {
                                                            "_class": "AST_Dot",
                                                            "expression": {
                                                              "_class": "AST_SymbolRef",
                                                              "name": "log",
                                                              "thedef": "1000038 log"
                                                            },
                                                            "property": "push"
                                                          },
                                                          "args": [
                                                            {
                                                              "_class": "AST_Call",
                                                              "expression": {
                                                                "_class": "AST_Dot",
                                                                "expression": {
                                                                  "_class": "AST_Dot",
                                                                  "expression": {
                                                                    "_class": "AST_Dot",
                                                                    "expression": {
                                                                      "_class": "AST_SymbolRef",
                                                                      "name": "Array",
                                                                      "thedef": "1000179 Array"
                                                                    },
                                                                    "property": "prototype"
                                                                  },
                                                                  "property": "slice"
                                                                },
                                                                "property": "call"
                                                              },
                                                              "args": [
                                                                {
                                                                  "_class": "AST_SymbolRef",
                                                                  "name": "arguments",
                                                                  "thedef": "1000040 arguments"
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "deepEqual"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "log",
                                                    "thedef": "1000038 log"
                                                  },
                                                  {
                                                    "_class": "AST_Array",
                                                    "elements": [
                                                      {
                                                        "_class": "AST_Array",
                                                        "elements": [
                                                          {
                                                            "_class": "AST_String",
                                                            "value": "127.0.0.1",
                                                            "quote": "'"
                                                          },
                                                          {
                                                            "_class": "AST_Number",
                                                            "value": 0
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "_class": "AST_Array",
                                                        "elements": [
                                                          {
                                                            "_class": "AST_String",
                                                            "value": "10.0.0.1",
                                                            "quote": "'"
                                                          },
                                                          {
                                                            "_class": "AST_Number",
                                                            "value": 1
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "with all trusted",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000043 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr",
                        "1000170 all"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return socket address with no headers",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000044 arguments",
                                  "1000045 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000045 req",
                                  "1000170 all"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000045 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000045 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "all",
                                              "thedef": "1000170 all"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "127.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return header value",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000046 arguments",
                                  "1000047 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000047 req",
                                  "1000170 all"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000047 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000047 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "all",
                                              "thedef": "1000170 all"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return furthest header value",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000048 arguments",
                                  "1000049 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000049 req",
                                  "1000170 all"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000049 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000049 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "all",
                                              "thedef": "1000170 all"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "with none trusted",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000050 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr",
                        "1000172 none"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return socket address with no headers",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000051 arguments",
                                  "1000052 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000052 req",
                                  "1000172 none"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000052 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000052 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "none",
                                              "thedef": "1000172 none"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "127.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return socket address with headers",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000053 arguments",
                                  "1000054 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000054 req",
                                  "1000172 none"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000054 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000054 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "none",
                                              "thedef": "1000172 none"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "127.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "with some trusted",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000055 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr",
                        "1000174 trust10x"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return socket address with no headers",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000056 arguments",
                                  "1000057 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000057 req",
                                  "1000174 trust10x"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000057 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000057 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "trust10x",
                                              "thedef": "1000174 trust10x"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "127.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return socket address when not trusted",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000058 arguments",
                                  "1000059 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000059 req",
                                  "1000174 trust10x"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000059 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000059 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "trust10x",
                                              "thedef": "1000174 trust10x"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "127.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return header when socket trusted",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000060 arguments",
                                  "1000061 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000061 req",
                                  "1000174 trust10x"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000061 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000061 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "trust10x",
                                              "thedef": "1000174 trust10x"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return first untrusted after trusted",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000062 arguments",
                                  "1000063 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000063 req",
                                  "1000174 trust10x"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000063 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000063 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "trust10x",
                                              "thedef": "1000174 trust10x"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should not skip untrusted",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000064 arguments",
                                  "1000065 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000065 req",
                                  "1000174 trust10x"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000065 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.3, 192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000065 req"
                                            },
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "trust10x",
                                              "thedef": "1000174 trust10x"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when given array",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000066 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr",
                        "1000177 describe"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept literal IP addresses",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000067 arguments",
                                  "1000068 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000068 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000068 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000068 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.2",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should not trust non-IP addresses",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000069 arguments",
                                  "1000070 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000070 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000070 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2, localhost",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000070 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.2",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "localhost",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return socket address if none match",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000071 arguments",
                                  "1000072 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000072 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000072 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000072 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "127.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "192.168.0.100",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "describe",
                              "thedef": "1000177 describe"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "when array empty",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000073 arguments"
                                ],
                                "enclosed": [
                                  "1000178 it",
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should return socket address ",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000074 arguments",
                                            "1000075 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000075 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000075 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "proxyaddr",
                                                      "thedef": "1000002 proxyaddr"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000075 req"
                                                      },
                                                      {
                                                        "_class": "AST_Array",
                                                        "elements": []
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "127.0.0.1",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should return socket address with headers",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000076 arguments",
                                            "1000077 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000077 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000077 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      },
                                                      {
                                                        "_class": "AST_Object",
                                                        "properties": [
                                                          {
                                                            "_class": "AST_ObjectKeyVal",
                                                            "quote": "'",
                                                            "key": "x-forwarded-for",
                                                            "value": {
                                                              "_class": "AST_String",
                                                              "value": "10.0.0.1, 10.0.0.2",
                                                              "quote": "'"
                                                            }
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "proxyaddr",
                                                      "thedef": "1000002 proxyaddr"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000077 req"
                                                      },
                                                      {
                                                        "_class": "AST_Array",
                                                        "elements": []
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "127.0.0.1",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when given IPv4 addresses",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000078 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept literal IP addresses",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000079 arguments",
                                  "1000080 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000080 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000080 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000080 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.2",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept CIDR notation",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000081 arguments",
                                  "1000082 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000082 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000082 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.200",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000082 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.2/26",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.200",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept netmask notation",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000083 arguments",
                                  "1000084 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000084 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000084 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.200",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000084 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.2/255.255.255.192",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.200",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when given IPv6 addresses",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000085 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept literal IP addresses",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000086 arguments",
                                  "1000087 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000087 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000087 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "fe80::1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "2002:c000:203::1, fe80::2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000087 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "fe80::1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "fe80::2",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "2002:c000:203::1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept CIDR notation",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000088 arguments",
                                  "1000089 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000089 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000089 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "fe80::1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "2002:c000:203::1, fe80::ff00",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000089 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "fe80::/125",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "fe80::ff00",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when IP versions mixed",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000090 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should match respective versions",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000091 arguments",
                                  "1000092 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000092 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000092 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "::1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "2002:c000:203::1",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000092 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "127.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "::1",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "2002:c000:203::1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should not match IPv4 to IPv6",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000093 arguments",
                                  "1000094 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000094 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000094 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "::1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "2002:c000:203::1",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000094 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "::1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when IPv4-mapped IPv6 addresses",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000095 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should match IPv4 trust to IPv6 request",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000096 arguments",
                                  "1000097 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000097 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000097 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "::ffff:a00:1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000097 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.2",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should match IPv4 netmask trust to IPv6 request",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000098 arguments",
                                  "1000099 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000099 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000099 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "::ffff:a00:1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000099 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "10.0.0.1/16",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should match IPv6 trust to IPv4 request",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000100 arguments",
                                  "1000101 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000101 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000101 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000101 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "::ffff:a00:1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "::ffff:a00:2",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "192.168.0.1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should match CIDR notation for IPv4-mapped address",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000102 arguments",
                                  "1000103 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000103 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000103 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.200",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000103 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "::ffff:a00:2/122",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.200",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should match CIDR notation for IPv4-mapped address mixed with IPv6 CIDR",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000104 arguments",
                                  "1000105 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000105 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000105 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.200",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000105 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "::ffff:a00:2/122",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "fe80::/125",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.200",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should match CIDR notation for IPv4-mapped address mixed with IPv4 addresses",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000106 arguments",
                                  "1000107 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000107 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000107 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "192.168.0.1, 10.0.0.200",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000107 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "::ffff:a00:2/122",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "127.0.0.1",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "10.0.0.200",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when given pre-defined names",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000108 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept single pre-defined name",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000109 arguments",
                                  "1000110 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000110 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000110 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "fe80::1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "2002:c000:203::1, fe80::2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000110 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "linklocal",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "2002:c000:203::1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should accept multiple pre-defined names",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000111 arguments",
                                  "1000112 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000112 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000112 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "::1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "2002:c000:203::1, fe80::2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000112 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "loopback",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_String",
                                                  "value": "linklocal",
                                                  "quote": "'"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "2002:c000:203::1",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when header contains non-ip addresses",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000113 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr",
                        "1000179 Array"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should stop at first non-ip after trusted",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000114 arguments",
                                  "1000115 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000115 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000115 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "myrouter, 127.0.0.1, proxy",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000115 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "proxy",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should stop at first malformed ip after trusted",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000116 arguments",
                                  "1000117 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000117 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000117 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "myrouter, 127.0.0.1, ::8:8:8:8:8:8:8:8:8",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "equal"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000117 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_String",
                                          "value": "::8:8:8:8:8:8:8:8:8",
                                          "quote": "'"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should provide all values to function",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000118 arguments",
                                  "1000119 log",
                                  "1000120 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000002 proxyaddr",
                                  "1000120 req",
                                  "1000119 log",
                                  "1000179 Array",
                                  "1000001 assert"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "log",
                                          "thedef": "1000119 log"
                                        },
                                        "value": {
                                          "_class": "AST_Array",
                                          "elements": []
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000120 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "myrouter, 127.0.0.1, proxy",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "proxyaddr",
                                        "thedef": "1000002 proxyaddr"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_SymbolRef",
                                          "name": "req",
                                          "thedef": "1000120 req"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [
                                            {
                                              "_class": "AST_SymbolFunarg",
                                              "name": "addr",
                                              "thedef": "1000122 addr"
                                            },
                                            {
                                              "_class": "AST_SymbolFunarg",
                                              "name": "i",
                                              "thedef": "1000123 i"
                                            }
                                          ],
                                          "uses_arguments": true,
                                          "variables": [
                                            "1000121 arguments",
                                            "1000122 addr",
                                            "1000123 i"
                                          ],
                                          "enclosed": [
                                            "1000119 log",
                                            "1000179 Array",
                                            "1000121 arguments"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Return",
                                              "value": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "log",
                                                    "thedef": "1000119 log"
                                                  },
                                                  "property": "push"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_Dot",
                                                          "expression": {
                                                            "_class": "AST_SymbolRef",
                                                            "name": "Array",
                                                            "thedef": "1000179 Array"
                                                          },
                                                          "property": "prototype"
                                                        },
                                                        "property": "slice"
                                                      },
                                                      "property": "call"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "arguments",
                                                        "thedef": "1000121 arguments"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "deepEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_SymbolRef",
                                          "name": "log",
                                          "thedef": "1000119 log"
                                        },
                                        {
                                          "_class": "AST_Array",
                                          "elements": [
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "127.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_Number",
                                                  "value": 0
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "proxy",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_Number",
                                                  "value": 1
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": [
                                                {
                                                  "_class": "AST_String",
                                                  "value": "127.0.0.1",
                                                  "quote": "'"
                                                },
                                                {
                                                  "_class": "AST_Number",
                                                  "value": 2
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "when socket address undefined",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000124 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000180 undefined",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return undefined as address",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000125 arguments",
                                  "1000126 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000180 undefined",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000126 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000126 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "undefined",
                                              "thedef": "1000180 undefined"
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "strictEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000126 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_SymbolRef",
                                          "name": "undefined",
                                          "thedef": "1000180 undefined"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return undefined even with trusted headers",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000127 arguments",
                                  "1000128 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000180 undefined",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000128 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000128 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "undefined",
                                              "thedef": "1000180 undefined"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "127.0.0.1, 10.0.0.1",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "strictEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "proxyaddr",
                                            "thedef": "1000002 proxyaddr"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000128 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_SymbolRef",
                                          "name": "undefined",
                                          "thedef": "1000180 undefined"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          }
        ]
      }
    },
    {
      "_class": "AST_SimpleStatement",
      "body": {
        "_class": "AST_Call",
        "expression": {
          "_class": "AST_SymbolRef",
          "name": "describe",
          "thedef": "1000177 describe"
        },
        "args": [
          {
            "_class": "AST_String",
            "value": "proxyaddr.all(req, [trust])",
            "quote": "'"
          },
          {
            "_class": "AST_Function",
            "name": null,
            "argnames": [],
            "uses_arguments": false,
            "variables": [
              "1000129 arguments"
            ],
            "enclosed": [
              "1000177 describe",
              "1000178 it",
              "1000001 assert",
              "1000002 proxyaddr",
              "1000166 createReq"
            ],
            "body": [
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "arguments",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000130 arguments"
                      ],
                      "enclosed": [
                        "1000177 describe",
                        "1000178 it",
                        "1000001 assert",
                        "1000002 proxyaddr",
                        "1000166 createReq"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "describe",
                              "thedef": "1000177 describe"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "req",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000131 arguments"
                                ],
                                "enclosed": [
                                  "1000178 it",
                                  "1000001 assert",
                                  "1000002 proxyaddr"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should be required",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000132 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Dot",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "proxyaddr",
                                                      "thedef": "1000002 proxyaddr"
                                                    },
                                                    "property": "all"
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "req.*required"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "describe",
                              "thedef": "1000177 describe"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "trust",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000133 arguments"
                                ],
                                "enclosed": [
                                  "1000178 it",
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should be optional",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000134 arguments",
                                            "1000135 req"
                                          ],
                                          "enclosed": [
                                            "1000166 createReq",
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000135 req"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "req",
                                                    "thedef": "1000135 req"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "createReq",
                                                      "thedef": "1000166 createReq"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "127.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "doesNotThrow"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "all"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_SymbolRef",
                                                        "name": "req",
                                                        "thedef": "1000135 req"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "with no headers",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000136 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should return socket address",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000137 arguments",
                                  "1000138 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000138 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000138 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "deepEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_Dot",
                                            "expression": {
                                              "_class": "AST_SymbolRef",
                                              "name": "proxyaddr",
                                              "thedef": "1000002 proxyaddr"
                                            },
                                            "property": "all"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000138 req"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_Array",
                                          "elements": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "with x-forwarded-for header",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000139 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should include x-forwarded-for",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000140 arguments",
                                  "1000141 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000141 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000141 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "deepEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_Dot",
                                            "expression": {
                                              "_class": "AST_SymbolRef",
                                              "name": "proxyaddr",
                                              "thedef": "1000002 proxyaddr"
                                            },
                                            "property": "all"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000141 req"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_Array",
                                          "elements": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should include x-forwarded-for in correct order",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000142 arguments",
                                  "1000143 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000143 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000143 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "deepEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_Dot",
                                            "expression": {
                                              "_class": "AST_SymbolRef",
                                              "name": "proxyaddr",
                                              "thedef": "1000002 proxyaddr"
                                            },
                                            "property": "all"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000143 req"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_Array",
                                          "elements": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.2",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              },
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "with trust argument",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000144 arguments"
                      ],
                      "enclosed": [
                        "1000178 it",
                        "1000166 createReq",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should stop at first untrusted",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000145 arguments",
                                  "1000146 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000146 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000146 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "deepEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_Dot",
                                            "expression": {
                                              "_class": "AST_SymbolRef",
                                              "name": "proxyaddr",
                                              "thedef": "1000002 proxyaddr"
                                            },
                                            "property": "all"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000146 req"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_Array",
                                          "elements": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_String",
                                              "value": "10.0.0.2",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "it",
                              "thedef": "1000178 it"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "should be only socket address for no trust",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000147 arguments",
                                  "1000148 req"
                                ],
                                "enclosed": [
                                  "1000166 createReq",
                                  "1000001 assert",
                                  "1000002 proxyaddr",
                                  "1000148 req"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_Var",
                                    "definitions": [
                                      {
                                        "_class": "AST_VarDef",
                                        "name": {
                                          "_class": "AST_SymbolVar",
                                          "name": "req",
                                          "thedef": "1000148 req"
                                        },
                                        "value": {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_SymbolRef",
                                            "name": "createReq",
                                            "thedef": "1000166 createReq"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            },
                                            {
                                              "_class": "AST_Object",
                                              "properties": [
                                                {
                                                  "_class": "AST_ObjectKeyVal",
                                                  "quote": "'",
                                                  "key": "x-forwarded-for",
                                                  "value": {
                                                    "_class": "AST_String",
                                                    "value": "10.0.0.1, 10.0.0.2",
                                                    "quote": "'"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_Dot",
                                        "expression": {
                                          "_class": "AST_SymbolRef",
                                          "name": "assert",
                                          "thedef": "1000001 assert"
                                        },
                                        "property": "deepEqual"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_Call",
                                          "expression": {
                                            "_class": "AST_Dot",
                                            "expression": {
                                              "_class": "AST_SymbolRef",
                                              "name": "proxyaddr",
                                              "thedef": "1000002 proxyaddr"
                                            },
                                            "property": "all"
                                          },
                                          "args": [
                                            {
                                              "_class": "AST_SymbolRef",
                                              "name": "req",
                                              "thedef": "1000148 req"
                                            },
                                            {
                                              "_class": "AST_Array",
                                              "elements": []
                                            }
                                          ]
                                        },
                                        {
                                          "_class": "AST_Array",
                                          "elements": [
                                            {
                                              "_class": "AST_String",
                                              "value": "127.0.0.1",
                                              "quote": "'"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          }
        ]
      }
    },
    {
      "_class": "AST_SimpleStatement",
      "body": {
        "_class": "AST_Call",
        "expression": {
          "_class": "AST_SymbolRef",
          "name": "describe",
          "thedef": "1000177 describe"
        },
        "args": [
          {
            "_class": "AST_String",
            "value": "proxyaddr.compile(trust)",
            "quote": "'"
          },
          {
            "_class": "AST_Function",
            "name": null,
            "argnames": [],
            "uses_arguments": false,
            "variables": [
              "1000149 arguments"
            ],
            "enclosed": [
              "1000177 describe",
              "1000178 it",
              "1000001 assert",
              "1000002 proxyaddr"
            ],
            "body": [
              {
                "_class": "AST_SimpleStatement",
                "body": {
                  "_class": "AST_Call",
                  "expression": {
                    "_class": "AST_SymbolRef",
                    "name": "describe",
                    "thedef": "1000177 describe"
                  },
                  "args": [
                    {
                      "_class": "AST_String",
                      "value": "arguments",
                      "quote": "'"
                    },
                    {
                      "_class": "AST_Function",
                      "name": null,
                      "argnames": [],
                      "uses_arguments": false,
                      "variables": [
                        "1000150 arguments"
                      ],
                      "enclosed": [
                        "1000177 describe",
                        "1000178 it",
                        "1000001 assert",
                        "1000002 proxyaddr"
                      ],
                      "body": [
                        {
                          "_class": "AST_SimpleStatement",
                          "body": {
                            "_class": "AST_Call",
                            "expression": {
                              "_class": "AST_SymbolRef",
                              "name": "describe",
                              "thedef": "1000177 describe"
                            },
                            "args": [
                              {
                                "_class": "AST_String",
                                "value": "trust",
                                "quote": "'"
                              },
                              {
                                "_class": "AST_Function",
                                "name": null,
                                "argnames": [],
                                "uses_arguments": false,
                                "variables": [
                                  "1000151 arguments"
                                ],
                                "enclosed": [
                                  "1000178 it",
                                  "1000001 assert",
                                  "1000002 proxyaddr"
                                ],
                                "body": [
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should be required",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000152 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Dot",
                                                    "expression": {
                                                      "_class": "AST_SymbolRef",
                                                      "name": "proxyaddr",
                                                      "thedef": "1000002 proxyaddr"
                                                    },
                                                    "property": "compile"
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "argument.*required"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept an array",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000153 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_Array",
                                                          "elements": []
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept a string",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000154 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_String",
                                                          "value": "127.0.0.1",
                                                          "quote": "'"
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should reject a number",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000155 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_Number",
                                                        "value": 42
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "unsupported trust argument"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept IPv4",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000156 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_String",
                                                          "value": "127.0.0.1",
                                                          "quote": "'"
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept IPv6",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000157 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_String",
                                                          "value": "::1",
                                                          "quote": "'"
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept IPv4-style IPv6",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000158 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_String",
                                                          "value": "::ffff:127.0.0.1",
                                                          "quote": "'"
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept pre-defined names",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000159 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_String",
                                                          "value": "loopback",
                                                          "quote": "'"
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should accept pre-defined names in array",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000160 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_Array",
                                                          "elements": [
                                                            {
                                                              "_class": "AST_String",
                                                              "value": "loopback",
                                                              "quote": "'"
                                                            },
                                                            {
                                                              "_class": "AST_String",
                                                              "value": "10.0.0.1",
                                                              "quote": "'"
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should reject non-IP",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000161 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "blargh",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid IP address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "-1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid IP address"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should reject bad CIDR",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000162 arguments"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1/6000",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::1/6000",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::ffff:a00:2/136",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "throws"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_Call",
                                                    "expression": {
                                                      "_class": "AST_Dot",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "property": "bind"
                                                    },
                                                    "args": [
                                                      {
                                                        "_class": "AST_Null"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "::ffff:a00:2/-46",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "_class": "AST_RegExp",
                                                    "value": {
                                                      "raw_source": "invalid range on address"
                                                    }
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "_class": "AST_SimpleStatement",
                                    "body": {
                                      "_class": "AST_Call",
                                      "expression": {
                                        "_class": "AST_SymbolRef",
                                        "name": "it",
                                        "thedef": "1000178 it"
                                      },
                                      "args": [
                                        {
                                          "_class": "AST_String",
                                          "value": "should not alter input array",
                                          "quote": "'"
                                        },
                                        {
                                          "_class": "AST_Function",
                                          "name": null,
                                          "argnames": [],
                                          "uses_arguments": false,
                                          "variables": [
                                            "1000163 arguments",
                                            "1000164 arr"
                                          ],
                                          "enclosed": [
                                            "1000001 assert",
                                            "1000002 proxyaddr",
                                            "1000164 arr"
                                          ],
                                          "body": [
                                            {
                                              "_class": "AST_Var",
                                              "definitions": [
                                                {
                                                  "_class": "AST_VarDef",
                                                  "name": {
                                                    "_class": "AST_SymbolVar",
                                                    "name": "arr",
                                                    "thedef": "1000164 arr"
                                                  },
                                                  "value": {
                                                    "_class": "AST_Array",
                                                    "elements": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "loopback",
                                                        "quote": "'"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "equal"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_UnaryPrefix",
                                                    "operator": "typeof",
                                                    "expression": {
                                                      "_class": "AST_Call",
                                                      "expression": {
                                                        "_class": "AST_Dot",
                                                        "expression": {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "proxyaddr",
                                                          "thedef": "1000002 proxyaddr"
                                                        },
                                                        "property": "compile"
                                                      },
                                                      "args": [
                                                        {
                                                          "_class": "AST_SymbolRef",
                                                          "name": "arr",
                                                          "thedef": "1000164 arr"
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "_class": "AST_String",
                                                    "value": "function",
                                                    "quote": "'"
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "_class": "AST_SimpleStatement",
                                              "body": {
                                                "_class": "AST_Call",
                                                "expression": {
                                                  "_class": "AST_Dot",
                                                  "expression": {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "assert",
                                                    "thedef": "1000001 assert"
                                                  },
                                                  "property": "deepEqual"
                                                },
                                                "args": [
                                                  {
                                                    "_class": "AST_SymbolRef",
                                                    "name": "arr",
                                                    "thedef": "1000164 arr"
                                                  },
                                                  {
                                                    "_class": "AST_Array",
                                                    "elements": [
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "loopback",
                                                        "quote": "'"
                                                      },
                                                      {
                                                        "_class": "AST_String",
                                                        "value": "10.0.0.1",
                                                        "quote": "'"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          }
        ]
      }
    },
    {
      "_class": "AST_Defun",
      "name": {
        "_class": "AST_SymbolDefun",
        "name": "createReq",
        "thedef": "1000166 createReq"
      },
      "argnames": [
        {
          "_class": "AST_SymbolFunarg",
          "name": "socketAddr",
          "thedef": "1000167 socketAddr"
        },
        {
          "_class": "AST_SymbolFunarg",
          "name": "headers",
          "thedef": "1000168 headers"
        }
      ],
      "uses_arguments": false,
      "variables": [
        "1000165 arguments",
        "1000167 socketAddr",
        "1000168 headers"
      ],
      "enclosed": [
        "1000167 socketAddr",
        "1000168 headers"
      ],
      "body": [
        {
          "_class": "AST_Return",
          "value": {
            "_class": "AST_Object",
            "properties": [
              {
                "_class": "AST_ObjectKeyVal",
                "key": "connection",
                "value": {
                  "_class": "AST_Object",
                  "properties": [
                    {
                      "_class": "AST_ObjectKeyVal",
                      "key": "remoteAddress",
                      "value": {
                        "_class": "AST_SymbolRef",
                        "name": "socketAddr",
                        "thedef": "1000167 socketAddr"
                      }
                    }
                  ]
                }
              },
              {
                "_class": "AST_ObjectKeyVal",
                "key": "headers",
                "value": {
                  "_class": "AST_Binary",
                  "operator": "||",
                  "left": {
                    "_class": "AST_SymbolRef",
                    "name": "headers",
                    "thedef": "1000168 headers"
                  },
                  "right": {
                    "_class": "AST_Object",
                    "properties": []
                  }
                }
              }
            ]
          }
        }
      ]
    },
    {
      "_class": "AST_Defun",
      "name": {
        "_class": "AST_SymbolDefun",
        "name": "all",
        "thedef": "1000170 all"
      },
      "argnames": [],
      "uses_arguments": false,
      "variables": [
        "1000169 arguments"
      ],
      "body": [
        {
          "_class": "AST_Return",
          "value": {
            "_class": "AST_True"
          }
        }
      ]
    },
    {
      "_class": "AST_Defun",
      "name": {
        "_class": "AST_SymbolDefun",
        "name": "none",
        "thedef": "1000172 none"
      },
      "argnames": [],
      "uses_arguments": false,
      "variables": [
        "1000171 arguments"
      ],
      "body": [
        {
          "_class": "AST_Return",
          "value": {
            "_class": "AST_False"
          }
        }
      ]
    },
    {
      "_class": "AST_Defun",
      "name": {
        "_class": "AST_SymbolDefun",
        "name": "trust10x",
        "thedef": "1000174 trust10x"
      },
      "argnames": [
        {
          "_class": "AST_SymbolFunarg",
          "name": "addr",
          "thedef": "1000175 addr"
        }
      ],
      "uses_arguments": false,
      "variables": [
        "1000173 arguments",
        "1000175 addr"
      ],
      "enclosed": [
        "1000175 addr"
      ],
      "body": [
        {
          "_class": "AST_Return",
          "value": {
            "_class": "AST_Call",
            "expression": {
              "_class": "AST_Dot",
              "expression": {
                "_class": "AST_RegExp",
                "value": {
                  "raw_source": "^10\\."
                }
              },
              "property": "test"
            },
            "args": [
              {
                "_class": "AST_SymbolRef",
                "name": "addr",
                "thedef": "1000175 addr"
              }
            ]
          }
        }
      ]
    }
  ]
}
