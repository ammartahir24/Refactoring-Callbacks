"use strict";var exec=require("child_process").exec;var chokidar=require("chokidar");function grep(e){return e.split(/[\r\n]/m).filter(function(e){var n=[/nothing to be done/i,/(entering|leaving) directory/i,/^[ \s]*$/];for(var r=0;r<n.length;r++){if(e.match(n[r]))return false}return true}).join("\n")}var timeout=null;var is_making=false;var run_on_end=false;function do_make(){if(timeout)clearTimeout(timeout);if(is_making){run_on_end=true;return}timeout=setTimeout(function(){timeout=null;is_making=true;exec("c:/msys2/usr/bin/make",function(e,n,r){if(e)console.error("error: ",e);if(n){n=grep(n).trim();if(n)console.log(n)}if(r)console.error(r);is_making=false;if(run_on_end)do_make();run_on_end=false})},100)}function main(){var e={ignored:[/(^|[\/\\])\../],ignoreInitial:true};console.log("Start fs monitor");do_make();chokidar.watch(".",e).on("all",function(e,n){console.log("fs: ",e,n);do_make()})}main();
